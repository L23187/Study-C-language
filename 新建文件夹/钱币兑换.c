#include<stdio.h>
int main(){
	int N,n,coy[100],i,j,k;
	double rate[5][5],money;
	while(scanf("%d",&N)!=EOF){
		while(N--){
			for(i=0;i<5;i++){
				for(j=0;j<5;j++){
					scanf("%lf",&rate[i][j]);
				}
			}
			while(1){
				scanf("%d",&n);
				if(n==0) break;
				for(j=0;j<n;j++){
					scanf("%d",&coy[j]);
				}
				scanf("%lf",&money);
				//四舍五入计算钱数 
				int t=0;
				for(j=0;j<n;j++){
					money*=rate[t][coy[j]-1];
					money=(int)(money*100+0.5)/100.0;
					t=coy[j]-1;
				}
				money*=rate[t][0];
				money=(int)(money*100+0.5)/100.0;		
				printf("%.2lf\n",money);			
			}
			if(N>=1){
				printf("\n");			
			} 
		}
	}
	return 0;
}
/*
2
1 1.57556 1.10521 0.691426 7.25005
0.634602 1 0.701196 0.43856 4.59847
0.904750 1.42647 1 0.625627 6.55957
1.44616 2.28059 1.59840 1 10.4843
0.137931 0.217555 0.152449 0.0953772 1
3 2 4 5 20.00
1 3 100.00
6 2 3 4 2 4 3 120.03
0
1 1.57556 1.10521 0.691426 7.25005
0.634602 1 0.701196 0.43856 4.59847
0.904750 1.42647 1 0.625627 6.55957
1.44616 2.28059 1.59840 1 10.4843
0.137931 0.217555 0.152449 0.0953772 1
3 2 4 5 20.00
1 3 100.00
6 2 3 4 2 4 3 120.03
0
*/

